<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8">
        <title>Quiz for Directory Entry</title>
        <link rel= "stylesheet" href="style.css">
        <style type="text/css">
                h1{
                        text-align: center;
                }
        </style>
    </head>
    <body>
        <nav>
                <div class="logo">
                    <a href="index.html"><img src="Logo.png" alt="Logo"></a>
                </div>
                <ul>
                    <li><a href="index.html">Home</a></li>
                    <li>
                        <a href="#" class="dropdown">About</a>
                        <ul>
                            <li><a href="about.html">About Us</a></li>
                            <li><a href="testimony.html">Testimonials</a></li>
                            <li><a href="contact.html">Contact</a></li>
                        </ul>
                    </li>
                    <li>
                        <a href="#" class="dropdown">Database</a>
                        <ul>
                            <li><a href="directory1.html">On-Campus</a></li>
                            <li><a href="directory2.html">Off-Campus</a></li>
                        </ul>
                    </li>
                    <li><a href="quiz.html">Quiz</a></li>
                </ul>
        </nav>
        <div class="main-content">
                <h1>Take our Housing Survey</h1>
                <div class="form-container">
                        <div class="form-row">
                                <div class="form-group">
                                <label>Name:</label>
                                <input type="text" id="name" required>
                                <div id="name-error" class="error"></div>
                                </div>
                                <div class="form-group">
                                <label>Hometown:</label>
                                <input type="text" id="hometown" required>
                                </div>
                        </div>

                        <div class="form-row">
                                <div class="form-group">
                                <label>Major:</label>
                                <input type="text" id="major" required>
                                </div>
                                <div class="form-group">
                                <label>Gender:</label>
                                <select id="gender">
                                        <option value="Male">Male</option>
                                        <option value="Female">Female</option>
                                        <option value="Other">Other</option>
                                </select>
                                </div>
                        </div>

                        <div class="form-row">
                                <div class="form-group">
                                <label>Cleanliness (1-10):</label>
                                <input type="number" id="cleanliness" min="1" max="10" required>
                                <div id="cleanliness-error" class="error"></div>
                                </div>
                                <div class="form-group">
                                        <label>Living Location:</label>
                                        <select id="onCampus" required>
                                        <option value="" disabled selected>Select your location</option>
                                        <option value="true">On Campus</option>
                                        <option value="false">Off Campus</option>
                                        </select>
                                <div id="onCampus-error" class="error"></div>
                                </div>
                        </div>

                        <div class="form-row">
                                <div class="form-group">
                                <label>Wakeup Time:</label>
                                <input type="time" id="wakeup" required>
                                </div>
                                <div class="form-group">
                                <label>Bedtime:</label>
                                <input type="time" id="bedtime" required>
                                </div>
                        </div>

                        <div class="form-row">
                                <div class="form-group">
                                <label>Smoker:</label>
                                <select id="smoker">
                                        <option value="true">Yes</option>
                                        <option value="false">No</option>
                                </select>
                                </div>
                        </div>
                        <button class="cta-button" onclick="validateAndGenerateResult()">Submit</button>
                        
                
                </div>
                
                <div class="result-container" id="results"></div>
        </div>

        <script>
                const onCampusPeople = [
                    { name: "Alice", hometown: "Springfield", major: "Computer Science", gender: "Female", cleanliness: 8, img: "smileyface.png", wakeup:"09:00", bedtime:"23:00", smoker: true },
                    { name: "Bob", hometown: "Hometownville", major: "Physics", gender: "Male", cleanliness: 6, img: "smileyface.png", wakeup:"09:00", bedtime:"23:00", smoker: true },
                    { name: "Carol", hometown: "Riverton", major: "Mathematics", gender: "Female", cleanliness: 9, img: "smileyface.png", wakeup: "07:30", bedtime: "22:30", smoker: false },
                    { name: "Dave", hometown: "Lakeside", major: "Biology", gender: "Male", cleanliness: 5, img: "smileyface.png", wakeup: "08:00", bedtime: "00:00", smoker: false },
                    { name: "Eve", hometown: "Meadowbrook", major: "English", gender: "Female", cleanliness: 7, img: "smileyface.png", wakeup: "06:45", bedtime: "23:15", smoker: false },
                    { name: "Ginny", hometown: "Lakeview", major: "Mathematics", gender: "Female", cleanliness: 8, img: "smileyface.png", wakeup: "08:30", bedtime: "23:00", smoker: false },
                    { name: "Nick", hometown: "Brakerston", major: "Biology", gender: "Male", cleanliness: 6.5, img: "smileyface.png", wakeup: "10:00", bedtime: "00:00", smoker: false },
                    { name: "Mia", hometown: "Springfield", major: "Economics", gender: "Female", cleanliness: 6, img: "smileyface.png", wakeup: "08:00", bedtime: "23:00", smoker: false },
                    { name: "Noah", hometown: "Hometownville", major: "Computer Science", gender: "Male", cleanliness: 8, img: "smileyface.png", wakeup: "09:00", bedtime: "00:00", smoker: true },
                    { name: "Olivia", hometown: "Greenfield", major: "Physics", gender: "Female", cleanliness: 7, img: "smileyface.png", wakeup: "08:00", bedtime: "23:30", smoker: false },
                    { name: "Paul", hometown: "Lakeside", major: "History", gender: "Male", cleanliness: 6, img: "smileyface.png", wakeup: "07:00", bedtime: "23:00", smoker: true },
                    { name: "Quinn", hometown: "Riverton", major: "Psychology", gender: "Non-binary", cleanliness: 9, img: "smileyface.png", wakeup: "06:30", bedtime: "22:00", smoker: false },
                    { name: "Jack", hometown: "Bergenfield", major: "Business", gender: "Male", cleanliness: 8, img: "smileyface.png", wakeup: "8:30", bedtime: "23:00", smoker: false },
                    { name: "Lila", hometown: "Lexington", major: "Biology", gender: "Female", cleanliness: 7, img: "smileyface.png", wakeup: "10:00", bedtime: "23:30", smoker: true }
                ];

                const offCampusPeople = [
                    { name: "Ella", hometown: "Springfield", major: "Computer Science", gender: "Female", cleanliness: 6, img: "smileyface.png", wakeup:"09:00", bedtime:"23:00", smoker: true },
                    { name: "Grace", hometown: "Oakville", major: "Psychology", gender: "Female", cleanliness: 8, img: "smileyface.png", wakeup: "08:30", bedtime: "22:00", smoker: false },
                    { name: "Henry", hometown: "Brookside", major: "Philosophy", gender: "Male", cleanliness: 6, img: "smileyface.png", wakeup: "09:30", bedtime: "23:30", smoker: true },
                    { name: "Isabel", hometown: "Sunnydale", major: "Psychology", gender: "Female", cleanliness: 10, img: "smileyface.png", wakeup: "07:00", bedtime: "21:30", smoker: false },
                    { name: "Jack", hometown: "Hilltop", major: "Engineering", gender: "Male", cleanliness: 3, img: "smileyface.png", wakeup: "06:00", bedtime: "23:45", smoker: false },
                    { name: "Karen", hometown: "Riverside", major: "Political Science", gender: "Female", cleanliness: 7, img: "smileyface.png", wakeup: "07:15", bedtime: "22:45", smoker: false },
                    { name: "Leo", hometown: "Pinecrest", major: "Business", gender: "Male", cleanliness: 5, img: "smileyface.png", wakeup: "08:00", bedtime: "23:00", smoker: true },
                    { name: "Riley", hometown: "Sunnydale", major: "Engineering", gender: "Female", cleanliness: 4, img: "smileyface.png", wakeup: "09:00", bedtime: "01:00", smoker: true },
                    { name: "Sophia", hometown: "Meadowbrook", major: "Art", gender: "Female", cleanliness: 10, img: "smileyface.png", wakeup: "07:00", bedtime: "22:00", smoker: false },
                    { name: "Tom", hometown: "Brookside", major: "Business", gender: "Male", cleanliness: 5, img: "smileyface.png", wakeup: "10:00", bedtime: "23:45", smoker: false },
                    { name: "Uma", hometown: "Oakville", major: "Biology", gender: "Female", cleanliness: 8, img: "smileyface.png", wakeup: "08:30", bedtime: "23:00", smoker: false },
                    { name: "Victor", hometown: "Pinecrest", major: "Chemistry", gender: "Male", cleanliness: 7, img: "smileyface.png", wakeup: "09:00", bedtime: "00:30", smoker: true },
                    { name: "Wendy", hometown: "Hilltop", major: "Environmental Science", gender: "Female", cleanliness: 9, img: "smileyface.png", wakeup: "07:45", bedtime: "22:30", smoker: false }
                ];

                function timeDiff(t1, t2) {
                        h1 = Number(t1.split(":")[0]);
                        m1 =  Number(t1.split(":")[1]);
                        h2 =  Number(t2.split(":")[0]);
                        m2 =  Number(t2.split(":")[1]);
                        minuteDiff = Math.abs(h1 * 60 + m1 - (h2 *60 + m2));
                        if (minuteDiff > 720) 
                                minuteDiff = 1440 - minuteDiff;
                        return minuteDiff / 60;
                }

                function calculateCompatibility(user, person) {
                        let score = 100;
                        wakeupDiff = timeDiff(user.wakeup, person.wakeup);
                        bedtimeDiff = timeDiff(user.bedtime, person.bedtime);
                        cleanDiff = Math.abs(user.cleanliness - person.cleanliness);
                        if (wakeupDiff > 1) 
                                score -= 5 * wakeupDiff;

                        if (bedtimeDiff > 1)
                                score -= 5 * bedtimeDiff;

                        score -= 3 * cleanDiff;

                        if (user.smoker != person.smoker)
                                score -= 20;

                        return score;
                }
            
                function validateAndGenerateResult() {
                        let valid = true;
                        document.getElementById("name-error").innerText = "";
                        document.getElementById("cleanliness-error").innerText = "";
                        document.getElementById("onCampus-error").innerText = "";

                        const name = document.getElementById("name").value.trim();
                        if (name === "") {
                                document.getElementById("name-error").innerText = "Name is required.";
                                valid = false;
                        }

                        const cleanlinessScore = parseInt(document.getElementById("cleanliness").value, 10);
                        if (isNaN(cleanlinessScore) || cleanlinessScore < 1 || cleanlinessScore > 10) {
                                document.getElementById("cleanliness-error").innerText = "Cleanliness must be between 1 and 10.";
                                valid = false;
                        }

                        const onCampusSelection = document.getElementById("onCampus").value;
                        if (!onCampusSelection) {
                                document.getElementById("onCampus-error").innerText = "Please select where you want to live.";
                                valid = false;
                        }

                        if (!valid) return;

                        const user = {wakeup : document.getElementById("wakeup").value, 
                                    bedtime : document.getElementById("bedtime").value, 
                                    smoker : document.getElementById("smoker").value === "true",
                                    cleanliness :cleanlinessScore};
                        
                                    
                        onCampus = onCampusSelection === "true";
                        const peopleList = onCampus ? onCampusPeople : offCampusPeople;

                        const compatibilityArray = peopleList.map(person => ({
                                person,
                                compatibilityScore: calculateCompatibility(user, person)
                        }));
                        compatibilityArray.sort((a, b) => b.compatibilityScore - a.compatibilityScore);
                        
                        let newHTML = "";

                        compatibilityArray.forEach(person => {
                                newHTML += ` <div class="person">
                                                        <img src="${person.person.img}" alt="Photo of ${person.person.name}">
                                                        <h3>${person.person.name} (Score: ${person.compatibilityScore.toFixed(2)})</h3>
                                                        Hometown: ${person.person.hometown}<br>
                                                        Major: ${person.person.major}<br>
                                                        Gender: ${person.person.gender}<br>
                                                        Cleanliness: ${person.person.cleanliness}/10<br>
                                                        Wakeup: ${person.person.wakeup}<br>
                                                        Bedtime: ${person.person.bedtime}<br>
                                                        Smoker: ${person.person.smoker ? "Yes" : "No"}
                                                </div> `;
                        });
                        document.getElementById("results").innerHTML = newHTML
                }
        </script>
    </body>
</html>
